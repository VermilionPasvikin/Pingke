<view class="container">
  <view class="header">
    <text class="title">æˆ‘çš„è®¨è®º</text>
    <text class="count">å…± {{total}} æ¡</text>
  </view>

  <view class="tabs">
    <view class="tab {{activeTab === 0 ? 'active' : ''}}" bindtap="switchTab" data-tab="0">
      å…¨éƒ¨ ({{total}})
    </view>
    <view class="tab {{activeTab === 1 ? 'active' : ''}}" bindtap="switchTab" data-tab="1">
      è®¨è®º ({{discussionsCount}})
    </view>
    <view class="tab {{activeTab === 2 ? 'active' : ''}}" bindtap="switchTab" data-tab="2">
      å›å¤ ({{repliesCount}})
    </view>
  </view>

  <view class="discussions-list">
    <view class="discussion-item" wx:for="{{displayList}}" wx:key="id">
      <view class="discussion-header">
        <view class="course-name">{{item.course.name}}</view>
        <view class="type-badge {{item.type}}">
          {{item.type === 'discussion' ? 'è®¨è®º' : 'å›å¤'}}
        </view>
      </view>

      <view class="parent-info" wx:if="{{item.type === 'reply'}}">
        <text class="parent-label">å›å¤ï¼š</text>
        <text class="parent-author">{{item.parent_author}}</text>
        <text class="parent-content">ã€Œ{{item.parent_content}}ã€</text>
      </view>

      <view class="content">{{item.content}}</view>

      <view class="footer">
        <view class="date">{{item.created_at}}</view>
        <view class="stats">
          <text class="likes">ğŸ‘ {{item.likes_count || 0}}</text>
        </view>
        <view class="actions">
          <text class="action-btn delete" bindtap="deleteDiscussion" data-id="{{item.id}}" data-type="{{item.type}}">åˆ é™¤</text>
        </view>
      </view>
    </view>
  </view>

  <view class="empty" wx:if="{{displayList.length === 0 && !loading}}">
    <text>æš‚æ— {{activeTab === 1 ? 'è®¨è®º' : activeTab === 2 ? 'å›å¤' : 'å†…å®¹'}}</text>
  </view>

  <view class="loading" wx:if="{{loading}}">
    <text>åŠ è½½ä¸­...</text>
  </view>
</view>
